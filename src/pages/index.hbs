<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Crypto Portfolio</title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <h1>Live Crypto Portfolio</h1>
    <div id="assets">
        <table>
            <thead>
                <tr>
                    <th>Coin</th>
                    <th>Quantity</th>
                    <th>Value in USDT</th>
                </tr>
            </thead>

          <tbody>
    {{#each coins}}
    <tr>
        <td>{{this}}</td>
        {{#with (lookup ../assets this)}}
        <td>{{quantity}}</td>
        <td>{{usdtEquivalent}} USDT</td>
        {{/with}}
    </tr>
    {{/each}}
</tbody>

        </table>
    </div>
    <hr>
    <h2>Total Value: <span>{{totalValue}} USDT</span></h2>
  <!-- WebSocket script added here -->
    <script>
        // const ws = new WebSocket('wss://ctrade.glitch.me');
      
      const ws = new WebSocket('wss://ctrade.glitch.me'); // Replace with your actual Glitch project URL

        ws.onopen = function() {
            console.log('WebSocket connection opened');
            ws.send('Hello Server!');
        };

        ws.onmessage = function(event) {
            console.log('Received data:', event.data);
        };

        ws.onerror = function(error) {
            console.log('WebSocket error:', error);
        };

        ws.onclose = function() {
            console.log('WebSocket connection closed');
        };
        
//         ws.onmessage = function(event) {
//             const data = JSON.parse(event.data);
//             console.log('Received data:', data);

//             // Update the specific coin's quantity and USDT equivalent
//             document.querySelector(`#quantity-${data.coin}`).innerText = data.quantity;
//             document.querySelector(`#usdtEquivalent-${data.coin}`).innerText = `${data.usdtEquivalent} USDT`;

//             // Update the total value
//             document.querySelector('#totalValue').innerText = `${data.totalValue} USDT`;
//         };
    </script>
</body>
</html>
